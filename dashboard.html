<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Stock Compensation Dashboard</title>
  <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
  <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@200;300;400;500;600;700;800&display=swap" rel="stylesheet"/>
  <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet"/>
  <script>
    tailwind.config = {
      darkMode: "class",
      theme: {
        extend: {
          colors: {
            "primary": "#2E7D32",
            "primary-light": "#A5D6A7",
            "background-light": "#f8fbfa",
            "background-dark": "#122017",
            "text-light": "#0e1a13",
            "text-dark": "#f8fbfa",
            "border-light": "#e8f2ec",
            "border-dark": "#2a3c31",
          },
          fontFamily: { "display": ["Manrope", "sans-serif"] },
          borderRadius: { "DEFAULT": "0.5rem","lg": "0.75rem","xl": "1rem","full": "9999px" },
        },
      },
    }
  </script>
  <link rel="stylesheet" href="./css/globals.css">
</head>
<body class="bg-background-light dark:bg-background-dark font-display text-text-light dark:text-text-dark">
<div class="relative flex min-h-screen w-full flex-col overflow-x-hidden">
  <div class="flex h-full grow flex-col">
    <div class="px-4 md:px-10 lg:px-20 xl:px-40 flex flex-1 justify-center py-5">
      <div class="flex flex-col max-w-6xl flex-1">
        <!-- Header -->
        <header class="flex items-center justify-between border-b border-border-light dark:border-border-dark px-4 md:px-10 py-3">
          <div class="flex items-center gap-4">
            <div class="size-6 text-primary">
              <svg fill="none" viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg">
                <path clip-rule="evenodd" d="M24 4H42V17.3333V30.6667H24V44H6V30.6667V17.3333H24V4Z" fill="currentColor" fill-rule="evenodd"></path>
              </svg>
            </div>
            <h2 class="text-lg font-bold">Stock Compensation</h2>
          </div>
          <div class="flex items-center gap-3">
            <button id="seed-btn" class="text-xs px-3 py-2 rounded-md border border-border-light hover:bg-primary-light/30">Seed Demo</button>
            <div class="bg-center bg-no-repeat aspect-square bg-cover rounded-full size-10" id="avatar"
                 style='background-image:url("https://images.unsplash.com/photo-1527980965255-d3b416303d12?q=80&w=300&auto=format&fit=crop");'></div>
            <button id="logout-btn" class="px-3 py-2 text-sm font-semibold rounded-md bg-primary text-white">Logout</button>
          </div>
        </header>

        <!-- Main -->
        <main class="flex-1 p-4 md:p-6 lg:p-8">
          <div class="flex flex-wrap justify-between gap-3 pb-6">
            <p class="text-4xl font-black">Dashboard</p>
          </div>

          <!-- KPI Cards -->
          <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
            <div class="flex flex-col gap-2 rounded-lg p-6 bg-primary-light/20 dark:bg-primary/20">
              <p class="text-base font-medium">Total Vested Value</p>
              <p id="kpi-vested-value" class="text-3xl font-bold">-</p>
              <p id="kpi-vested-delta" class="text-primary text-base font-medium">-</p>
            </div>
            <div class="flex flex-col gap-2 rounded-lg p-6 bg-primary-light/20 dark:bg-primary/20">
              <p class="text-base font-medium">Upcoming Vesting</p>
              <p id="kpi-upcoming-shares" class="text-3xl font-bold">-</p>
              <p id="kpi-upcoming-date" class="text-text-light/70 dark:text-text-dark/70 text-base">-</p>
            </div>
            <div class="flex flex-col gap-2 rounded-lg p-6 bg-primary-light/20 dark:bg-primary/20">
              <p class="text-base font-medium">Recent Transactions</p>
              <p id="kpi-recent-value" class="text-3xl font-bold">-</p>
              <p id="kpi-recent-type" class="text-red-500 text-base font-medium">-</p>
            </div>
          </div>

          <!-- Chart + Upcoming list -->
          <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mt-6">
            <div class="lg:col-span-2 flex flex-col gap-2 rounded-lg border border-border-light dark:border-border-dark p-6">
              <p class="text-base font-medium">Stock Value</p>
              <p id="chart-total" class="text-[32px] font-bold truncate">-</p>
              <div class="flex gap-1">
                <p class="text-text-light/70 dark:text-text-dark/70 text-base">Last 12 Months</p>
                <p id="chart-delta" class="text-primary text-base font-medium">-</p>
              </div>
              <div class="flex min-h-[220px] flex-1 flex-col gap-8 py-4">
                <!-- decorative area chart -->
                <svg fill="none" height="180" preserveAspectRatio="none" viewBox="-3 0 478 180" width="100%" xmlns="http://www.w3.org/2000/svg">
                  <path d="M0 130.8C18.1538 130.8 18.1538 25.2 36.3077 25.2C54.4615 25.2 54.4615 49.2 72.6154 49.2C90.7692 49.2 90.7692 111.6 108.923 111.6C127.077 111.6 127.077 39.6 145.231 39.6C163.385 39.6 163.385 121.2 181.538 121.2C199.692 121.2 199.692 73.2 217.846 73.2C236 73.2 236 54 254.154 54C272.308 54 272.308 145.2 290.462 145.2C308.615 145.2 308.615 178.8 326.769 178.8C344.923 178.8 344.923 1.2 363.077 1.2C381.231 1.2 381.231 97.2 399.385 97.2C417.538 97.2 417.538 154.8 435.692 154.8C453.846 154.8 453.846 30 472 30V178.8H326.769H0V130.8Z" fill="url(#paint0_linear)"></path>
                  <path d="M0 130.8C18.1538 130.8 18.1538 25.2 36.3077 25.2C54.4615 25.2 54.4615 49.2 72.6154 49.2C90.7692 49.2 90.7692 111.6 108.923 111.6C127.077 111.6 127.077 39.6 145.231 39.6C163.385 39.6 163.385 121.2 181.538 121.2C199.692 121.2 199.692 73.2 217.846 73.2C236 73.2 236 54 254.154 54C272.308 54 272.308 145.2 290.462 145.2C308.615 145.2 308.615 178.8 326.769 178.8C344.923 178.8 344.923 1.2 363.077 1.2C381.231 1.2 381.231 97.2 399.385 97.2C417.538 97.2 417.538 154.8 435.692 154.8C453.846 154.8 453.846 30 472 30" stroke="#2E7D32" stroke-linecap="round" stroke-width="3"></path>
                  <defs>
                    <linearGradient id="paint0_linear" x1="236" x2="236" y1="1.2" y2="178.8" gradientUnits="userSpaceOnUse">
                      <stop stop-color="#A5D6A7" stop-opacity="0.4"></stop>
                      <stop offset="1" stop-color="#A5D6A7" stop-opacity="0"></stop>
                    </linearGradient>
                  </defs>
                </svg>
                <div class="flex justify-around">
                  <p class="text-[13px] font-bold opacity-70">Jan</p><p class="text-[13px] font-bold opacity-70">Feb</p>
                  <p class="text-[13px] font-bold opacity-70">Mar</p><p class="text-[13px] font-bold opacity-70">Apr</p>
                  <p class="text-[13px] font-bold opacity-70">May</p><p class="text-[13px] font-bold opacity-70">Jun</p>
                  <p class="text-[13px] font-bold opacity-70">Jul</p>
                </div>
              </div>
            </div>

            <div class="flex flex-col gap-4 rounded-lg border border-border-light dark:border-border-dark p-6">
              <h2 class="text-[22px] font-bold">Upcoming Vesting</h2>
              <div id="upcoming-list" class="flex flex-col gap-4"></div>
              <p id="upcoming-empty" class="text-sm text-gray-500 hidden">등록된 베스팅 일정이 없습니다. 아래 Quick Actions에서 추가하세요.</p>
            </div>
          </div>

          <!-- Quick Actions -->
          <section class="grid grid-cols-1 lg:grid-cols-3 gap-6 mt-6">
            <!-- Add Grant -->
            <div class="rounded-lg border border-border-light p-6">
              <h3 class="text-lg font-bold mb-4">Add Grant</h3>
              <div class="space-y-3">
                <label class="block text-sm">Type
                  <select id="qa-grant-type" class="mt-1 w-full rounded-md border border-gray-300">
                    <option value="RSU">RSU</option>
                    <option value="OPTION">Option</option>
                  </select>
                </label>
                <label class="block text-sm">Total Shares
                  <input id="qa-grant-shares" type="number" class="mt-1 w-full rounded-md border border-gray-300" placeholder="e.g. 2000">
                </label>
                <label class="block text-sm">Grant Date
                  <input id="qa-grant-date" type="date" class="mt-1 w-full rounded-md border border-gray-300">
                </label>
                <label class="block text-sm">Exercise Price (옵션일 때)
                  <input id="qa-grant-price" type="number" step="0.01" class="mt-1 w-full rounded-md border border-gray-300" placeholder="0">
                </label>
                <button id="qa-grant-save" class="mt-2 w-full h-10 rounded-md bg-primary text-white font-semibold">Save Grant</button>
                <p id="qa-grant-msg" class="text-sm text-primary mt-1"></p>
              </div>
            </div>

            <!-- Add Vesting -->
            <div class="rounded-lg border border-border-light p-6">
              <h3 class="text-lg font-bold mb-4">Add Vesting</h3>
              <div class="space-y-3">
                <label class="block text-sm">Vesting Date
                  <input id="qa-vest-date" type="date" class="mt-1 w-full rounded-md border border-gray-300">
                </label>
                <label class="block text-sm">Shares
                  <input id="qa-vest-shares" type="number" class="mt-1 w-full rounded-md border border-gray-300" placeholder="e.g. 150">
                </label>
                <label class="inline-flex items-center gap-2 text-sm mt-1">
                  <input id="qa-vest-vested" type="checkbox" class="rounded border-gray-300">
                  <span>Already vested</span>
                </label>
                <button id="qa-vest-save" class="mt-2 w-full h-10 rounded-md bg-primary text-white font-semibold">Save Vesting</button>
                <p id="qa-vest-msg" class="text-sm text-primary mt-1"></p>
              </div>
            </div>

            <!-- Simulator -->
            <div class="rounded-lg border border-border-light p-6">
              <h3 class="text-lg font-bold mb-4">Simulator</h3>
              <div class="space-y-3">
                <label class="block text-sm">Assumed FMV (주가)
                  <input id="sim-fmv" type="number" step="0.01" class="mt-1 w-full rounded-md border border-gray-300" placeholder="e.g. 150">
                </label>
                <label class="block text-sm">Shares
                  <input id="sim-shares" type="number" class="mt-1 w-full rounded-md border border-gray-300" placeholder="e.g. 150">
                </label>
                <button id="sim-run" class="mt-2 w-full h-10 rounded-md bg-primary text-white font-semibold">Run</button>
                <div id="sim-result" class="mt-3 text-sm text-gray-700"></div>
              </div>
            </div>
          </section>

          <!-- Recent Transactions -->
          <div class="mt-8">
            <h2 class="text-[22px] font-bold px-1 pb-3">Recent Transactions</h2>
            <div class="overflow-x-auto border border-border-light rounded-lg">
              <table class="w-full text-left">
                <thead>
                  <tr class="border-b border-border-light">
                    <th class="p-3 text-sm font-semibold opacity-70">Date</th>
                    <th class="p-3 text-sm font-semibold opacity-70">Transaction Type</th>
                    <th class="p-3 text-sm font-semibold opacity-70">Shares</th>
                    <th class="p-3 text-sm font-semibold opacity-70 text-right">Value</th>
                  </tr>
                </thead>
                <tbody id="tx-tbody"></tbody>
              </table>
              <p id="tx-empty" class="p-3 text-sm text-gray-500 hidden">거래 내역이 없습니다.</p>
            </div>
          </div>
        </main>
      </div>
    </div>
  </div>
</div>

<script type="module" src="./js/firebase.js"></script>
<script type="module" src="./js/guards.js"></script>
<script type="module" src="./js/api.js"></script>
<script type="module" src="./js/utils.js"></script>
<script type="module" src="./js/dashboard.js"></script>
</body>
</html>
